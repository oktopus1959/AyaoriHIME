# AGENTS.md

このリポジトリは Windows 専用の日本語入力ツール AyaoriHIME です。
Visual Studio でビルドされます。
現在は TSF / COM を利用していないが、将来的には対応予定です。

## 前提と制約
- Windows 専用を維持する（クロスプラットフォーム化しない）
- TSF / COM のライフサイクル・スレッドモデルを厳守する
- wchar_t / UTF-16 / BSTR 前提を維持する
- 既存の設計意図と動作仕様を尊重する

## やってはいけない変更
- TSF / COM の初期化・解放・参照カウント処理を簡略化または変更する
- COM のスレッドモデル（STA/MTA）やメッセージループに影響する変更
- Unicode 取り扱いを UTF-8 前提に切り替える、または文字列型を置換する
- Windows 専用前提を崩す抽象化やクロスプラットフォーム化
- ビルドターゲットやツールチェーン（.NET Framework 4.8 / MSVC v143 等）を無断で変更
- 外部依存の追加や動作要件の変更（OS / ランタイム）
- 既存の入出力仕様やユーザー設定ファイル互換性の破壊

## 確認せずに実行してよいこと
- rg, ls など、ファイルやディレクトリ内容の確認だけを行い、内容の変更を伴わないコマンドの実行

## 作業方針
- 変更は最小限・局所的に行う
- 仕様変更や挙動変更は事前に合意を取る
- 文字コードと COM/TSF の契約を最優先で保護する
- docs/spec/*.md が存在する場合、それを最優先の指示として扱う
- スコープ外の変更は禁止。提案だけに留める
